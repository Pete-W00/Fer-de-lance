# SQL - Inner Joins and Outer joins

# Fictious data set - a list of pokemon and properties (not necessarily factual, from memory)
# The actual data is unimportant providing your tables keep the same column names (and the data is the same for same columns, e.g. data in poko is same for both tables):
# table1: poko_id, poko, the_type
# table2: poko_id, poko, my_rating, yellow
# table3: poko, my_rating, the_type, common, when_caught, weakness

# table1
poko_id	   poko	        type
1	         Haunter	     Ghost
2	         Bellsprout	  Grass
3	         Gengar	      Ghost
4	         Onix	        Rock
5	         Geodude	     Rock
6	         Mew	         Psychic
7	         Squirtle	    Water
8	         Ponyta	      Fire
9	         Snorlax	     Normal
10	        Voltorb	     Electric

# table2
poko_id	   poko	       my_rating	     yellow
1	         Haunter	    6	             Y
2	         Bellsprout	 4             	Y
3	         Gengar	     9	             N
4	         Onix	       6	             Y
5	         Geodude	    5	             Y
6	         Mew	        10	            N
7	         Squirtle	   7	             Y
8	         Ponyta	     5	             Y
9	         Snorlax	    9	             Y
10	        Voltorb	    5	             Y

# table3
poko	      my_rating	   the_type	   common	    when_caught	    weakness
Haunter	   6	           Ghost	      U	         MidGame	        Psychic
Bellsprout	4	           Grass	      C	         EarlyGame	      Psychic
Gengar	    9	           Ghost	      R	         Never	          Psychic
Onix	      6	           Rock	       C	         EarlyGame	      Water
Geodude	   5	           Rock	       C	         EarlyGame	      Water
Mew	       10	          Psychic	    R	         Never	          None
Squirtle	  7	           Water	      R	         Never	          Electric
Ponyta	    5	           Fire	       C	         MidGame	        Water
Snorlax	   9	           Normal	     R	         MidGame	        None
Voltorb	   5	           Electric	   C	         EarlyGame	      Rock 

# table 4
poko                  the_type
Ghastly               Ghost
Haunter               Ghost
Gengar                Ghost



CREATE DATABASE poko;
USE poko;                                                  # Refresh schemas and use import wizard to put csv files into SQL


SELECT*FROM table1;
 
SELECT*FROM table2;

SELECT*FROM table3;


SELECT*FROM table1
INNER JOIN table2
    ON table1.poko = table2.poko;                          # Joins the two tables

ALTER TABLE table1 RENAME COLUMN `type` TO the_type;       # type is a built in SQL command so not a good column name

SELECT table1.poko, the_type, my_rating                    # my_rating is data from table2
FROM table1
INNER JOIN table2 
    ON table1.poko = table2.poko;
    
SELECT table1.poko, the_type, yellow                       # yellow is data from table2
FROM table1
INNER JOIN table2 
    ON table1.poko = table2.poko;    
    
SELECT*FROM table3                                         # Joins with common column my_rating
INNER JOIN table2 
    ON table3.my_rating = table2.my_rating;
    
SELECT table3.my_rating, weakness, yellow                  # my_rating is common column, weakness is from table3 and yellow is from table2
FROM table3
INNER JOIN table2 
    ON table3.my_rating = table2.my_rating;    
    
# Different syntax for inner join (join)
SELECT table2.my_rating, yellow, when_caught               # my_rating is common column, yellow is table2 and when_caught is table3 
FROM table2, table3
WHERE table2.my_rating = table3.my_rating; 
    
# Join for all values in tables 1 and 2 (common data column is poko)
SELECT*FROM table1, table2
WHERE table1.poko = table2.poko;

# Joining three tables
SELECT table1.poko, table2.my_rating, table2.yellow, table3.common                   # Might be easier to always use the syntax tableName.columnValue so you know where the data is coming from
FROM table1
INNER JOIN table2
    ON table1.poko = table2.poko
INNER JOIN table3
    ON table2.my_rating = table3.my_rating;
# This joins poko column from table1 to my_rating and yellow columns in table2 and then common column in table3


# Outer joins

SELECT*FROM table4;

DELETE FROM table4 LIMIT 1;                       # extra row with column names included in import
								                                          
SELECT*FROM table1                                
INNER JOIN table4
    ON table1.the_type = table4.the_type;

SELECT*FROM table1                                # this works as an outer join - pokemon that are not ghost type are given null values
LEFT OUTER JOIN table4
    ON table1.the_type = table4.the_type;
    
SELECT*FROM table1                                # same output as inner join
RIGHT OUTER JOIN table4
    ON table1.the_type = table4.the_type;
